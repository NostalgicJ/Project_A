# 화장품 성분 조합 분석 AI - 발표용 플로우 차트

## 1. 전체 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────────┐
│                         사용자 인터페이스                             │
│                  (웹 UI / API / 모바일 앱)                            │
└────────────────────────────┬────────────────────────────────────────┘
                             │
                             ↓
┌─────────────────────────────────────────────────────────────────────┐
│                        FastAPI 서버                                  │
│  ┌──────────┬──────────┬──────────┬──────────┬──────────┐          │
│  │  제품   │  성분    │  제품 간 │   성분   │   인기   │          │
│  │  검색   │  분석    │  조합 분석│  추천    │  성분    │          │
│  └──────────┴──────────┴──────────┴──────────┴──────────┘          │
└────────────────────────────┬────────────────────────────────────────┘
                             │
                   ┌─────────┴─────────┐
                   ↓                   ↓
        ┌──────────────────┐  ┌──────────────────┐
        │  규칙 기반 모델   │  │  딥러닝 모델     │
        │  - 빠름          │  │  - 높은 정확도   │
        │  - 해석 가능     │  │  - 복잡한 패턴   │
        └──────────────────┘  └──────────────────┘
                   │                   │
                   └─────────┬─────────┘
                             ↓
              ┌──────────────────────────────┐
              │     성분 규칙 데이터베이스    │
              │  - 계열 정보                 │
              │  - 위험 조합                 │
              │  - 시너지 조합               │
              └──────────────────────────────┘
                             │
                             ↓
              ┌──────────────────────────────┐
              │      처리된 제품 데이터       │
              │  - 2,000+ 제품               │
              │  - 1,500+ 성분               │
              └──────────────────────────────┘
```

## 2. 데이터 수집 및 전처리 파이프라인

```
┌──────────────────┐
│  공공데이터 API  │──→ [다운로드] ──┐
└──────────────────┘                  │
                                      ├─→ [병합]
┌──────────────────┐                  │
│  올리브영 크롤링 │──→ [JSON 파싱] ──┘
└──────────────────┘                  │
                                      ↓
                          ┌───────────────────────┐
                          │  원본 데이터          │
                          │  - raw JSON files     │
                          └───────────┬───────────┘
                                      │
                                      ↓
                          ┌──────────────────────────┐
                          │  전처리                  │
                          │  1. 제품명 정제         │
                          │  2. 브랜드/제품명 분리   │
                          │  3. 성분 정규화          │
                          └───────────┬──────────────┘
                                      │
                    ┌─────────────────┼─────────────────┐
                    ↓                 ↓                 ↓
          ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
          │  확인된 성분  │  │  미확인 성분  │  │  기획 상품   │
          │  (자동)      │  │  (수동 검수) │  │  (수동 검수) │
          └──────────────┘  └──────────────┘  └──────────────┘
                    │                 │                 │
                    └─────────────────┴─────────────────┘
                                      │
                                      ↓
                          ┌──────────────────────────┐
                          │  최종 정제 데이터        │
                          │  - oliveyoung_products_  │
                          │    cleaned.csv           │
                          └──────────────────────────┘
```

## 3. 모델 학습 파이프라인

```
┌──────────────────────────┐
│    학습 데이터 준비      │
│  - 성분 어휘 사전 구축   │
│  - 성분 쌍 생성          │
│  - 라벨링                │
└────────┬─────────────────┘
         │
         ↓
┌────────────────────────────────────────────────────────┐
│              데이터 분할                               │
│  ┌────────────┐  ┌────────────┐  ┌────────────┐     │
│  │  Training  │  │Validation │  │    Test    │     │
│  │    70%     │  │    15%     │  │    15%     │     │
│  └────────────┘  └────────────┘  └────────────┘     │
└────────────────────────────────────────────────────────┘
         │
         ↓
┌──────────────────────────┐
│    모델 초기화           │
│  - Embedding layer       │
│  - Interaction network   │
│  - Output heads          │
└────────┬─────────────────┘
         │
         ↓ (For each epoch)
┌──────────────────────────┐
│    Forward Pass          │
│  - 임베딩                │
│  - 상호작용 분석         │
│  - 예측                  │
└────────┬─────────────────┘
         │
         ↓
┌──────────────────────────┐
│    손실 계산             │
│  - CrossEntropyLoss      │
│  - MSELoss               │
└────────┬─────────────────┘
         │
         ↓
┌──────────────────────────┐
│    Backward Pass         │
│  - Gradient 계산         │
│  - 파라미터 업데이트     │
└────────┬─────────────────┘
         │
         ↓ (50 epochs)
┌──────────────────────────┐
│    모델 평가             │
│  - Accuracy              │
│  - F1 Score              │
│  - ROC AUC               │
└────────┬─────────────────┘
         │
         ↓
┌──────────────────────────┐
│    모델 저장             │
│  - .pth 파일             │
└──────────────────────────┘
```

## 4. 분석 프로세스

```
사용자 입력
    │
    ├─ 제품 검색 ──────────────→ [제품 DB 검색] ──→ 결과
    │
    ├─ 성분 분석 ───→ [성분 리스트 입력]
    │                    │
    │                    ↓
    │           ┌────────────────┐
    │           │  성분 계열 분류 │
    │           └───────┬────────┘
    │                   │
    │                   ↓
    │           ┌────────────────┐
    │           │ 규칙/딥러닝 모델│
    │           └───────┬────────┘
    │                   │
    │                   ↓
    └──────────────────────────────→ [위험도/시너지 점수] ──→ 결과
                                           │
    제품 간 조합 ──→ [제품 A, B] ───────────┘
                        │
                        ↓
                ┌───────────────┐
                │  제품간 비교   │
                │  - A 성분     │
                │  - B 성분     │
                └───────┬───────┘
                        │
                        ↓
                [위험 조합 탐지] ──→ 결과
```

## 5. 성분 계열 매칭 과정

```
입력: "아스코빅애씨드", "레티놀"

    Step 1: 성분 추출
    ┌──────────────┐
    │ 아스코빅애씨드│
    │ 레티놀       │
    └──────┬───────┘
           │
           ↓
    Step 2: 계열 매칭
    ┌────────────────────────────────────────┐
    │ 계열 DB 조회                           │
    │ - 비타민C계열: [아스코빅애씨드, ...]    │
    │ - 레티놀계열: [레티놀, ...]            │
    └────────┬───────────────────────────────┘
             │
             ↓
    Step 3: 조합 규칙 적용
    ┌────────────────────────────────────────┐
    │ 위험 조합 검사:                        │
    │ ✅ 비타민C계열 + 레티놀계열 = 위험도 0.9│
    │ 이유: pH 불일치                        │
    └────────┬───────────────────────────────┘
             │
             ↓
    출력: 
    {
        "assessment": "위험",
        "danger_score": 0.9,
        "reason": "pH 불일치로 효과 상쇄"
    }
```

## 6. 제품 간 조합 비교 상세 프로세스

```
┌─────────────────────────┐         ┌─────────────────────────┐
│   제품 A                │         │   제품 B                │
│   - 비타민C             │         │   - 레티놀              │
│   - 히알루론산         │         │   - 세라마이드          │
│   - 나이아신아마이드   │         │   - 판테놀              │
└────────┬────────────────┘         └────────┬───────────────┘
         │                                    │
         ↓                                    ↓
┌──────────────────┐              ┌──────────────────┐
│ 성분 계열 분류   │              │ 성분 계열 분류   │
│ - 비타민C계열    │              │ - 레티놀계열     │
│ - 히알루론산계열 │              │ - 세라마이드계열 │
└────────┬─────────┘              └────────┬─────────┘
         │                                  │
         └──────────┬──────────────────────┘
                    │
                    ↓
        ┌───────────────────────────┐
        │  교차 매칭                │
        │  A 계열 ←→ B 계열         │
        └───────────┬───────────────┘
                    │
                    ↓
        ┌───────────────────────────┐
        │  위험 조합 탐지           │
        │  ⚠️ 비타민C계열 +        │
        │     레티놀계열 = 위험도 0.9│
        └───────────┬───────────────┘
                    │
                    ↓
        ┌───────────────────────────┐
        │  시너지 조합 탐지         │
        │  ✅ 히알루론산 + 세라마이드│
        └───────────┬───────────────┘
                    │
                    ↓
        ┌───────────────────────────┐
        │  최종 평가                │
        │  - 종합 위험도            │
        │  - 시너지 효과            │
        │  - 권장사항               │
        └───────────────────────────┘
```

## 7. 실제 사용 시나리오

```
사용자: "비타민C 세럼과 레티놀 크림을 함께 쓸 수 있을까?"

                ↓
        ┌────────────────┐
        │  제품 검색     │
        └───────┬────────┘
                │
                ↓
        ┌────────────────┐
        │  A: 비타민C 세럼│
        │  B: 레티놀 크림 │
        └───────┬────────┘
                │
                ↓
        ┌────────────────────────┐
        │  성분 추출             │
        │  A: [아스코빅애씨드, ...]│
        │  B: [레티놀, ...]      │
        └───────┬────────────────┘
                │
                ↓
        ┌────────────────────────┐
        │  조합 분석             │
        └───────┬────────────────┘
                │
                ↓
┌────────────────────────────────────┐
│  ❌ 위험 경고                       │
│                                    │
│  비타민C계열 + 레티놀계열          │
│  위험도: 90%                       │
│                                    │
│  이유: pH 불일치로 효과 상쇄       │
│  - 비타민C: 산성 (pH 3-4)         │
│  - 레티놀: 중성 (pH 6-7)          │
│                                    │
│  권장사항:                         │
│  ✅ 아침: 비타민C 세럼            │
│  ✅ 저녁: 레티놀 크림              │
│  ✅ 일주일 간격 사용               │
└────────────────────────────────────┘
```

## 8. 시스템 데이터 흐름도

```
[데이터 소스]
    ├─→ 공공데이터 API (성분 DB)
    │       └→ public_ingredients.csv
    │
    ├─→ 올리브영 크롤링 (제품 데이터)
    │       └→ oliveyoung_*.json
    │
    └─→ 전문가 검수 (규칙)
            └→ ingredient_rules.json
                    │
                    ↓
        ┌───────────────────────┐
        │  전처리 파이프라인     │
        └───────────┬───────────┘
                    │
                    ↓
        ┌───────────────────────┐
        │  정제된 데이터        │
        │  - products.csv      │
        │  - vocab.pkl         │
        └───────────┬───────────┘
                    │
                    ↓
        ┌───────────────────────┐
        │  모델 학습            │
        │  - train.py           │
        └───────────┬───────────┘
                    │
                    ↓
        ┌───────────────────────┐
        │  학습된 모델          │
        │  - model.pth          │
        └───────────┬───────────┘
                    │
                    ↓
        ┌───────────────────────┐
        │  API 서버             │
        │  - FastAPI            │
        └───────────┬───────────┘
                    │
                    ↓
            [사용자 응답]
```

이 플로우 차트들은 발표 자료나 문서에 직접 사용할 수 있습니다!
